<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Revenue</title>
</head>

<style>

</style>

<body>

    <script>
        const MARGINS = { top: 50, right: 20, bottom: 50, left: 20 };
        const CHART_WIDTH = 600;
        const CHART_HEIGHT = 400 - MARGINS.top - MARGINS.bottom;

        const x = d3.scaleBand().rangeRound([0, CHART_WIDTH]).padding(0.1);
        const y = d3.scaleLinear().range([CHART_HEIGHT, 0]);

        x.domain(DUMMY_DATA.map(data => data.month));
        y.domain([0, d3.max(DUMMY_DATA, data => data.revenue_actual + 3)]);

        const chartContainer = d3
            .select('svg')
            .attr('width', CHART_WIDTH)
            .attr('height', CHART_HEIGHT + MARGINS.top + MARGINS.bottom);

        const chart = chartContainer.append('g');

        chart
            .append('g')
            .call(d3.axisBottom(x).tickSizeOuter(0))
            .attr('transform', `translate(0, ${CHART_HEIGHT})`)
            .attr('color', '#4f009e');

        function renderChart() {
            chart
                .selectAll('.bar')
                .data(DUMMY_DATA, data => data.id)
                .enter()
                .append('rect')
                .classed('bar', true)
                .attr('width', x.bandwidth())
                .attr('height', data => CHART_HEIGHT - y(data.revenue_actual))
                .attr('x', data => x(data.month))
                .attr('y', data => y(data.revenue_actual));

            // chart
            //   .selectAll('.bar')
            //   .data(DUMMY_DATA, data => data.id)
            //   .exit()
            //   .remove();

            chart
                .selectAll('.label')
                .data(DUMMY_DATA, data => data.id)
                .enter()
                .append('text')
                .text(data => data.revenue_actual)
                .attr('x', data => x(data.month) + x.bandwidth() / 2)
                .attr('y', data => y(data.revenue_actual) - 20)
                .attr('text-anchor', 'middle')
                .classed('label', true);

            // chart
            //   .selectAll('.label')
            //   .data(DUMMY_DATA, data => data.id)
            //   .exit()
            //   .remove();
        }

        renderChart();
    </script>
</body>

</html>